{"version":3,"file":"19.6ecd5f1253d938653cf6.bundle.js","sources":["webpack:///../superset-ui-legacy-plugin-chart-force-directed/lib/ForceDirected.js"],"sourcesContent":["\"use strict\";exports.__esModule=!0,exports.default=void 0;var _d=_interopRequireDefault(require(\"d3\")),_propTypes=_interopRequireDefault(require(\"prop-types\"));require(\"./ForceDirected.css\");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */ /* eslint-disable no-magic-numbers, sort-keys, func-names */ /* eslint-disable no-param-reassign, babel/no-invalid-this */var propTypes={data:_propTypes.default.arrayOf(_propTypes.default.shape({source:_propTypes.default.string,target:_propTypes.default.string,value:_propTypes.default.number})),width:_propTypes.default.number,height:_propTypes.default.number,linkLength:_propTypes.default.number,charge:_propTypes.default.number};/* Modified from http://bl.ocks.org/d3noob/5141278 */function ForceDirected(a,b){var c=Math.sqrt,d=b.data,e=b.width,f=b.height,g=b.linkLength,h=void 0===g?200:g,i=b.charge,j=void 0===i?-500:i,k=_d.default.select(a);k.classed(\"superset-legacy-chart-force-directed\",!0);var l=d,m={};l.forEach(function(a){a.source=m[a.source]||(m[a.source]={name:a.source}),a.target=m[a.target]||(m[a.target]={name:a.target}),a.value=+a.value;var b=a.target.name,c=a.source.name;m[b].total===void 0&&(m[b].total=a.value),m[c].total===void 0&&(m[c].total=0),m[b].max===void 0&&(m[b].max=0),a.value>m[b].max&&(m[b].max=a.value),m[b].min===void 0&&(m[b].min=0),a.value>m[b].min&&(m[b].min=a.value),m[b].total+=a.value});/* eslint-enable no-use-before-define */var n=_d.default.layout.force().nodes(_d.default.values(m)).links(l).size([e,f]).linkDistance(h).charge(j).on(\"tick\",/* eslint-disable no-use-before-define */ // add the curvy lines\nfunction(){q.attr(\"d\",function(a){var b=a.target.x-a.source.x,d=a.target.y-a.source.y,e=c(b*b+d*d);return\"M\"+a.source.x+\",\"+a.source.y+\"A\"+e+\",\"+e+\" 0 0,1 \"+a.target.x+\",\"+a.target.y}),r.attr(\"transform\",function(a){return\"translate(\"+a.x+\",\"+a.y+\")\"})}).start();k.selectAll(\"*\").remove();var o=k.append(\"svg\").attr(\"width\",e).attr(\"height\",f);// build the arrow.\no.append(\"svg:defs\").selectAll(\"marker\").data([\"end\"])// Different link/path types can be defined here\n.enter().append(\"svg:marker\")// This section adds in the arrows\n.attr(\"id\",String).attr(\"viewBox\",\"0 -5 10 10\").attr(\"refX\",15).attr(\"refY\",-1.5).attr(\"markerWidth\",6).attr(\"markerHeight\",6).attr(\"orient\",\"auto\").append(\"svg:path\").attr(\"d\",\"M0,-5L10,0L0,5\");var p=_d.default.scale.linear().range([.1,.5]),q=o.append(\"svg:g\").selectAll(\"path\").data(n.links()).enter().append(\"svg:path\").attr(\"class\",\"link\").style(\"opacity\",function(a){return p(a.value/a.target.max)}).attr(\"marker-end\",\"url(#end)\"),r=o.selectAll(\".node\").data(n.nodes()).enter().append(\"g\").attr(\"class\",\"node\").on(\"mouseenter\",function(){_d.default.select(this).select(\"circle\").transition().style(\"stroke-width\",5),_d.default.select(this).select(\"text\").transition().style(\"font-size\",25)}).on(\"mouseleave\",function(){_d.default.select(this).select(\"circle\").transition().style(\"stroke-width\",1.5),_d.default.select(this).select(\"text\").transition().style(\"font-size\",12)}).call(n.drag),s=_d.default.extent(_d.default.values(m),function(a){return c(a.total)}),t=_d.default.scale.linear().domain(s).range([3,30]);// add the links and the arrows\n// add the text\nr.append(\"circle\").attr(\"r\",function(a){return t(c(a.total))}),r.append(\"text\").attr(\"x\",6).attr(\"dy\",\".35em\").text(function(a){return a.name})}ForceDirected.displayName=\"ForceDirected\",ForceDirected.propTypes=propTypes;var _default=ForceDirected;exports.default=_default;"],"mappings":"AAAA","sourceRoot":""}